# Расчёт управленческой зарплаты

На предприятии работают сотрудники двух категорий: специалисты и административный персонал. Специалистам начисляется минимальный оклад и процент за выполненные работы клиентам. Административный персонал получает оклад. Любому сотруднику на усмотрение руководства может быть начислена разовая фиксированная премия.

Сотрудники могут уходить в отпуск. В период отпуска оклад не начисляется. Отпускные рассчитываются из расчёта среднедневной заработной платы за последние 12 месяцев:

`(Начисленная сумма за 12 мес. / Количество рабочих дней) х Количество календарных дней отпуска`

С каждого сотрудника удерживается НДФЛ – 13%.

Для упрощения примем, что выплаты осуществляются один раз в месяц после начисления зарплаты. Кроме этого на предприятии планируются отпуска на год вперёд.

## Расчёт зарплаты

Для каждого сотрудника необходимо хранить суммы окладов. Дополнительно для специалистов необходимо хранить процент от выполненных заказов, который им будет начисляться. Расчёт зарплаты выполняется документом НачислениеЗаработнойПлаты по всем видам расчёта, кроме премий. Премии начисляются отдельным документом НачислениеФиксированныхПремий.

В документах НачислениеЗаработнойПлаты и НачислениеФиксированныхПремий должно быть автоматически рассчитано удержание НДФЛ.

**Алгоритм решения задачи:**
1. Добавьте планы видов расчёта ОсновныеНачисления, ДополнительныеНачисления и Удержания. Настройте их с учётом описанного сценария начислений
2. Создайте регистры расчёта ОсновныеНачисления, ДополнительныеНачисления и Удержания
3. Создайте регистр сведений УсловияОплатыСотрудников с периодичностью Месяц, измерением Сотрудник и ресурсами Оклад и ПроцентОтРабот.
4. Создайте регистр накопления ВыполненныеСотрудникомРаботы с измерением Сотрудник, ресурсами ЧасовКОплате и СуммаКОплате
5. Реализуйте в документе ОбслуживаниеКлиента алгоритм для формирования движений по регистру ВыполненныеСотрудникомРаботы.
   
   Если на дату документа специалисту не установлен процент оплаты от работ, то документ не должен проводится. Необходимо учитывать, что может быть установлен нулевой процент, в этом случае документ должен проводится.

   СуммаКОплате рассчитывается по формуе:

   `ЧасовКОплатеКлиенту * СтавкаЧасаКлиента * ПроцентОтРабот / 100`
   
7. Создайте документ НачисленияЗарплаты и реализуйте алгоритм расчёта в соответствии с требованиями к механизмам сложных периодических расчётов для экзамена 1С:Специалист по платформе.
8. Создайте документ НачислениеФиксированнойПремии с табличной частью СписокСотрудников (Сотрудник, СуммаПремии), реализуйте запись премии в регистр при проведении и расчёте НДФЛ.

## Выплата зарплаты

Необходимо учитывать начисленные и выплаченные суммы сотрудникам.

**Алгоритм решения задачи:**
1. Создайте регистр накопления ВзаиморасчетыССотрудниками с измерением Сотрудник и ресурсов Сумма.
2. Для документов НачислениеЗарплаты и НачислениеФиксированнойПремии реализуйте алгоритм формирования движений по регистру ВзаиморасчетыССотрудниками.

Сумма должна расчитываться как

`ОсновныеНачисления + ДополнительныеНачисления - Удержания`, 

зарегистрированные этим документом.

3. Создайте документ ВыплатаЗарплаты:
    - с табличной частью Выплаты (Сотрудник, Сумма),
    - с механизмом автозаполнения по остаткам регистра ВзаиморасчетыССотрудниками на дату документа.
4. Реализуйте механизм проведения документа с формированием движений по регистру ВзаиморасчетыССотрудниками

## Планирование отпусков

В начале года на предприятии составляется график отпусков. Необходимо реализовать возможность визуального контроля, что все сотрудники одновременно не уйдут в отпуск. 

**Алгоритм решения задачи:**
1. Создайте документ ГрафикОтпусков с реквизитом Год и табличной частью ОтпускаСотрудников (Сотрудник, ДатаНачала, ДатаОкончания)
2. Создайте форму документа, на форме реализуйте подсветку строк сотрудников, общая длительность отпуска которых более 28 календарных дней
3. Создайте дополнительную форму документа АнализГрафика, добавьте команду на открытие дополнительной формы на основную форму документа
4. На форме АнализГрафика отобразите диаграмму Ганта с запланированными отпусками сотрудников текущим документом в выбранном году. Данные из основной формы в дополнительную форму для построения диаграммы Ганта передаём через временное хранилище.

## Права доступа

Вводом информации о заработной плате, плановых отпусках занимаются кадровики-расчётчики.

**Алгоритм решения задачи:**
1. Создайте необходимые роли для работы с объектами
2. Добавьте поставляемый профиль групп доступа КадровикРасчетчик
3. Добавьте в профиль роли
